const generatePerPageGraderButton=function(e,t,r){e.setAttribute("kami-processed",!0);const a=document.createElement("div");a.id=t,a.classList.add("kami-per-page-grader-container"),a.style.visibility="hidden";const n=document.createElement("a");return n.classList.add("kami-per-page-grader-link"),n.innerHTML='<span class="kami-drive-viewer-open-app-icon"></span><span>Grade by Page</span><span class="kami-beta-indicator">beta</span>',n.href="javascript:void(0)",n.addEventListener("click",r),a.appendChild(n),a},attachPerPageGraderButtonGCSubmission=function(e,t){const r=generatePerPageGraderButton(e,t,handlePerPageGraderLinkClick(UrlMatcher.extractDataFromAssignmentPage));e.appendChild(r)},attachPerPageGraderButtonGCGrader=function(e,t){const r=generatePerPageGraderButton(e,t,handlePerPageGraderLinkClick(UrlMatcher.extraDataFromGraderPage)),a=e.lastChild;r.classList.add("kami-gc-grader"),e.insertBefore(r,a)},getAssignmentUrlAttributes=function(e){return e(window.location.href)},handlePerPageGraderLinkClick=function(e){return function(){const t=getAssignmentUrlAttributes(e);if(!t)return;const[r,a,n]=t,i="https://web.kamihq.com"+"/web/viewer.html?ppg_state=search&alternate_course_id="+r+"&alternate_course_work_id="+a+"&authuser="+n;window.open(i,"_blank")}},detectKamiAssignment=function(e,t){const r=getAssignmentUrlAttributes(t);if(!r)return;const[a,n,i]=r,o=document.createElement("iframe");o.setAttribute("data-kami-assignment-detector",!0),o.setAttribute("data-kami-grader-container-id",e),o.src=`https://classroom.google.com/u/${i}/c/${a}/a/${n}/details`,o.style.display="none",document.body.appendChild(o)};observers.customGrader=new MutationObserver((function(e){if(window.location.href.includes("details")&&window.self!==window.top){if(!(window.frameElement&&window.frameElement.getAttribute("data-kami-assignment-detector")))return;for(mutation of e){if(!mutation.addedNodes)return;const e=document.querySelector(".cSyPgb.WInaFd.QRiHXd");if(e){const t=e.textContent.endsWith("Kami"),r=window.frameElement.getAttribute("data-kami-grader-container-id");return window.parent.postMessage({from_kami_detector:!0,is_kami_assignment:t,grader_container_id:r}),void observers.customGrader.disconnect()}}}else if(window.location.href.includes("submissions"))for(mutation of e){if(!mutation.addedNodes)return;document.querySelectorAll(".Y5vSD.TIunU.xPSjRb").forEach((e=>{if(!e||e.querySelector(".kami-per-page-grader-container"))return;const t=`kami-button-${Math.floor(1e3*Math.random())}-${(new Date).getTime()}`;attachPerPageGraderButtonGCSubmission(e,t),detectKamiAssignment(t,UrlMatcher.extractDataFromAssignmentPage)}))}else if(UrlMatcher.isClassroomGrader(window.location.href))for(mutation of e){if(!mutation.addedNodes)return;const e=document.querySelector(".dnTXKd");if(!e||e.querySelector(".kami-per-page-grader-container"))return;const t=`kami-button-${Math.floor(1e3*Math.random())}-${(new Date).getTime()}`;attachPerPageGraderButtonGCGrader(e,t),detectKamiAssignment(t,UrlMatcher.extraDataFromGraderPage)}})),window.addEventListener("message",(e=>{if("https://classroom.google.com"!==e.origin)return;const{from_kami_detector:t,is_kami_assignment:r,grader_container_id:a}=e.data;if(!t)return;const n=document.getElementById(a);r&&n&&(n.style.visibility="visible");const{frameElement:i}=e.source;i&&i.parentElement&&i.parentElement.removeChild(i)})),observers.customGrader.observe(document.body,{childList:!0,subtree:!0});